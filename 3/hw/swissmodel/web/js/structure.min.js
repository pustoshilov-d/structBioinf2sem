var currentWin=window,main_NGL_module=null,main_pv=null,main_ngl=null,plip_bond_num_dash=5,plip_bond_radius=.1,plip_higlight_factor=2,plip_higlight_bond_num_dash=1,PLIP=PLIP||{};PLIP.AbstractViewer=null;var opacity_fadeout_ligand=.3,opacity_fadeout_protein=.3;
function takeSnapshot(a,b){".png"==a&&(a="structure.png");0<$("#pv:visible",currentWin.document).length&&$("#pv canvas")[0].toBlob(function(d){saveAs(d,a)});if(0<$("#ngl:visible",currentWin.document).length){b=b||1;var c=$("#snapshot_bg_transparent_checkbox").is(":checked");ngl_stage.makeImage({factor:b,antialias:!1,trim:!1,transparent:c}).then(function(d){NGL.download(d,a)})}}
function resetStructure(){$(".hoverResidue").removeClass("hoverResidue");$(".selectResidue").removeClass("selectResidue");0<$("#pv:visible",currentWin.document).length&&(pv_viewer.show("*ligands"),pv_viewer.hide("*ligands_lines"),pv_viewer.rm("*res"),pv_viewer.autoZoom(),pv_viewer.requestRedraw());0<$("#ngl:visible",currentWin.document).length&&(ngl_stage.eachRepresentation(function(a){-1<a.name.indexOf("hover")&&"none"!=a.repr.selection.string&&a.setSelection("none")}),ngl_stage.autoView(1200))}
function spin(a){"undefined"!==typeof pv_viewer&&pv_viewer.spin(a);null!=ngl_stage&&(a?ngl_stage.setSpin([0,1,0],-.005):ngl_stage.setSpin(0))}
function detach(a){if(currentWin==window){if(0<$("#pv:visible",currentWin.document).length)currentWin=window.open(a.replace("xx","pv"),"_blank","resizable=1,status=1,toolbar=1,location=1,height=700,width=700"),main_pv=pv_viewer;else if(0<$("#ngl:visible",currentWin.document).length)main_ngl=ngl_stage,main_NGL_module=NGL,currentWin=window.open(a.replace("xx","ngl"),"_blank","resizable=1,status=1,toolbar=1,location=1,height=700,width=700");else return;$("#left-panel").removeClass();$("#right-panel").hide();
$(window).trigger("resize")}}function attachPV(){pv_viewer=main_pv;attach()}function attachNGL(){var a=ngl_stage.viewerControls.getOrientation();NGL=main_NGL_module;ngl_stage=main_ngl;ngl_stage.removeAllComponents();showNGL(a);attach()}
function attach(){currentWin=window;for(var a=$("#right-panel").attr("class").split(/\s+/),b=0;b<a.length;b++)size=a[b].split("-"),3==size.length&&$("#left-panel").addClass(size[0]+"-"+size[1]+"-"+(12-parseInt(size[2])));$("#right-panel").hasClass("col-threeeighths")&&$("#left-panel").addClass("col-fiveeighths");$("#right-panel").show();$(window).trigger("resize");"undefined"!=typeof superposeTemplates&&superposeTemplates(!0);refreshBondsAndLigandHighlights()}
function refreshBondsAndLigandHighlights(a){refreshHighlightLigands(a);refreshBonds(a)}function refreshBonds(a){void 0===a?plip_bonds.refreshAll():plip_bonds.refresh(a)}function refreshHighlightLigands(a){void 0===a?all_ligands.redrawAll():all_ligands.redraw(a)}function centerOnLigand(a,b){0<$("#pv:visible",currentWin.document).length&&centerOnLigandPV(a,b);0<$("#ngl:visible",currentWin.document).length&&centerOnLigandNGL(a,b)}
function highlightLigand(a,b,c){$(".ligandContact").removeClass("ligandContact");for(var d={},e=0;e<b.length;e++)b[e]&&"_"!=b[e].charAt(0)&&(res=b[e].substring(1),chain=b[e].charAt(0),d[chain]||(d[chain]=[]),d[chain].push(res));var f=$(".alignTbl tr[struc_id="+c+"]"),g=f[0].hasAttribute("keyseqchain")?"keyseqchain":"chain",h;for(h in d){var k=f.filter("["+g+"="+h+"]").find("span").toArray();for(e=0;e<d[h].length;e++)for(var n=0;n<k.length;n++)if(k[n].getAttribute("s")==d[h][e]){k[n].className="ligandContact";
break}}0<$("#pv:visible",currentWin.document).length&&highlightLigandPV(d,b,c);0<$("#ngl:visible",currentWin.document).length&&highlightLigandNGL(a,b,c)}
$("body").on("highlightResidue",function(a,b){if("structure"!=b.src&&"varianceChart"!=b.src)if(null==b.chain&&null==b.resno)0<$("#pv:visible",currentWin.document).length&&pv_viewer.rm(b.struc_id+"_res"),0<$("#ngl:visible",currentWin.document).length&&ngl_stage.getRepresentationsByName(b.struc_id+".hover").list[0].setSelection("none");else{if(0<$("#pv:visible",currentWin.document).length)return highlightResiduesPV(b.chain,b.resno,b.struc_id,b.multiple);if(0<$("#ngl:visible",currentWin.document).length)return highlightResiduesNGL(b.chain,
b.resno,b.struc_id,b.multiple)}});$("body").on("centerResRange",function(a,b){0<$("#pv:visible",currentWin.document).length&&centerResRangePV(b.chain,b.min,b.max,b.struc_id,b.isDisulfid,b.secondChain);0<$("#ngl:visible",currentWin.document).length&&centerResRangeNGL(b.chain,b.min,b.max,b.struc_id,b.isDisulfid,b.secondChain)});
$("body").on("connectResidues",function(a,b){0<$("#pv:visible",currentWin.document).length&&connectResiduesPV(b.residuePairs);0<$("#ngl:visible",currentWin.document).length&&connectResiduesNGL(b.residuePairs)});
function selectResidues(a,b,c,d){if(null==a&&null==b)0<$("#pv:visible",currentWin.document).length&&pv_viewer.rm(c+"_res"),0<$("#ngl:visible",currentWin.document).length&&("undefined"!==typeof all_ligands&&"undefined"!==typeof plip_residues?highlightLigandNGL(all_ligands.getVisibleLigandIds(c),plip_residues.getVisibleResiduesResId(c),c,d):highlightResiduesNGL([],[],c,d));else{if(0<$("#pv:visible",currentWin.document).length)return highlightResiduesPV(a,b,c,d);if(0<$("#ngl:visible",currentWin.document).length)return highlightResiduesNGL(a,
b,c,d)}}function changeRep(a){a||(a="cartoon");0<$("#pv:visible",currentWin.document).length&&(changeRepPV(a),null!=pv_viewer&&0<pv_viewer.all().length&&("undefined"!==typeof detached&&detached?window.opener.updatecols():updatecols()));0<$("#ngl:visible",currentWin.document).length&&(changeRepNGL(a),"undefined"!==typeof detached&&detached?window.opener.updatecols():updatecols())}function updatecolsSingleRes(a){$(".alignTbl").first().alignment("updateColoursSingleResidue",a)}
function updatecols(a){$(".alignTbl").first().alignment("viewerInitialised",{strucId:a})}var ngl_stage=null,ngl_picked_atom=!1,ngl_picked_component=!1;
function getNGL(){var a="white";$.cookie("bg_r")&&(a="rgb("+$.cookie("bg_r")+","+$.cookie("bg_r")+","+$.cookie("bg_r")+")");ngl_stage=new NGL.Stage("ngl",{backgroundColor:a,hoverTimeout:.005,sampleLevel:2,tooltip:!1});a=(new NGL.Matrix4).makeRotationX(Math.PI/2);a=(new NGL.Quaternion).setFromRotationMatrix(a);ngl_stage.viewerControls.rotate(a);a=(new NGL.Matrix4).makeRotationY(Math.PI);a=(new NGL.Quaternion).setFromRotationMatrix(a);ngl_stage.viewerControls.rotate(a);ngl_stage.signals.clicked.add(function(b){if(b&&
(b.atom||b.bond)){var c=b.atom||b.closestBondAtom;b.component.autoView(c.resno+":"+c.chainname,1E3)}});ngl_stage.signals.hovered.add(function(b){if(!ngl_stage.mouseObserver.pressed)if(b&&(b.atom||b.bond)){var c=b.atom||b.closestBondAtom;if(!ngl_picked_atom||c.structure.name!=ngl_picked_atom.structure.name||c.index!=ngl_picked_atom.index){var d=getNGLRepresentationByName(b.component.name);ngl_picked_atom=c;ngl_picked_component=b.component;var e=c.resname+" "+c.resno+c.inscode;"_"!=c.chainname&&(e+=
" "+c.chainname);"_"!=c.chainname&&["cartoon","tube","rope"].includes(d.repr.type)&&"CA"==c.atomname||(e+=" "+c.atomname);$("#ngl_status").text(e);$("body").trigger("highlightResidue",{src:"structure",struc_id:b.component.name,chain:c.chainname,resno:c.resno});"undefined"!==typeof detached&&detached?(window.opener.ngl_picked_atom=ngl_picked_atom,window.opener.updatecolsSingleRes({struc_id:b.component.name,chain:c.chainname,resno:c.resno})):updatecolsSingleRes({struc_id:b.component.name,chain:c.chainname,
resno:c.resno})}}else ngl_picked_atom&&(ngl_picked_atom=!1,$("#ngl_status").text(""),"undefined"!==typeof detached&&detached?(window.opener.ngl_picked_atom=ngl_picked_atom,window.opener.updatecolsSingleRes(ngl_picked_atom)):updatecolsSingleRes(ngl_picked_atom))});return ngl_stage}function getNGLComponentByName(a){return ngl_stage.getComponentsByName(a).list[0]}function getNGLRepresentationByName(a){return ngl_stage.getRepresentationsByName(a).list[0]}
function removeNGLComponentByName(a){a=getNGLComponentByName(a);ngl_stage.removeComponent(a)}
function highlightResiduesNGL(a,b,c,d){var e="";if(b){ngl_stage.eachRepresentation(function(n){-1<n.name.indexOf("hover")&&-1==n.name.indexOf(c)&&"none"!=n.repr.selection.string&&n.setVisibility(!1)});var f=getNGLRepresentationByName(c+".hover");if(f){f.setVisibility(!0);d&&(e=f.repr.selection.string+" ",e.startsWith("none")&&(e=e.substring(5)));var g=getNGLComponentByName(c).structure;d="";for(var h=0;h<a.length;h++)if(b.length)for(var k=0;k<b.length;k++)b[k][0]==b[k][1]?isResidueInStructureNGL(g,
a[h],b[k][0])&&(d+=b[k][0]+":"+a[h]+" "):(console.warn("Not checking if the selection is part of the structure"),d+=b[k][0]+"-"+b[k][1]+":"+a[h]+" ");else isResidueInStructureNGL(g,a[h],b)&&(d+=b+":"+a[h]+" ");new_selection=e+d;""==new_selection&&(new_selection="none");f.setSelection(new_selection);return new_selection}}else{e=getNGLComponentByName(c);d="";if(e){if(1==a.length)d=(b?b:"")+":"+a;else for(h=0;h<a.length;h++)d+=(b?b:"")+":"+a[h]+" ";e.autoView(d,1E3)}return d}}
function centerResRangeNGL(a,b,c,d,e,f){for(var g="",h=getNGLComponentByName(d).structure,k=0;k<a.length;k++)for(var n=f?b:c,m=b;m<=n;m++)e&&m!=b&&m!=n||isResidueInStructureNGL(h,a[k],m)&&(g+=m+":"+a[k]+" ");if(f)for(k=0;k<f.length;k++)isResidueInStructureNGL(h,f[k],c)&&(g+=c+":"+f[k]+" ");""!=g&&getNGLComponentByName(d).autoView(g,1E3)}
function centerOnLigandNGL(a,b){for(var c=a[0]+":_",d=1;d<a.length;d++)c+=" "+a[d]+":_";for(var e in ngl_stage.compList)if(ngl_stage.compList[e].name==b){ngl_stage.compList[e].autoView(c,1E3);break}}
function contactListToNGLSelection(a,b,c){var d={},e=null;if(void 0===c||null==c)c=[];if(b&&0<b.length){var f=getNGLComponentByName(a).structure;for(a=0;a<b.length;a++)if(b[a]){e=b[a].charAt(0);var g=parseInt(b[a].substring(1));"_"==e&&-1==c.indexOf(g)&&c.push(g);isResidueInStructureNGL(f,e,g)&&"-"!=e&&(d[e]||(d[e]=[]),d[e][g]=1)}}g=b="";for(e in d){b+=" ( (";g+=" ( (";f=!0;for(a=0;a<d[e].length;a++)if(d[e][a]){f?f=!1:(b+=" or ",g+=" or ");b+=a;g+=a-2;start=a;do a++;while(d[e][a]);1<a-start&&(b+=
"-"+(a-1));g+="-"+(a+1)}b+=") AND :"+e+") ";g+=") AND :"+e+") "}return[b,g,c]}function isResidueInStructureNGL(a,b,c){var d={};try{a.eachChain(function(e){e.chainname==b&&(first_residue=e.residueStore.resno[e.residueOffset],last_residue=e.residueStore.resno[e.residueEnd],e.eachResidue(function(f){if(f.resno==c)throw d;}))})}catch(e){if(e===d)return!0}return!1}
function highlightLigandNGL(a,b,c,d,e){removeNGLComponentByName(c+"ligandBondsHL");void 0===d&&(d="undefined"===typeof extra_residues_selection?[]:extra_residues_selection);void 0===e&&(e="undefined"===typeof extra_ranges_selection?[]:extra_ranges_selection);residue_contacts=b.concat(d);ranges_contacts=residue_contacts.concat(e);var f=contactListToNGLSelection(c,residue_contacts,a);a=f[2];b=contactListToNGLSelection(c,ranges_contacts);f=f[0];b=b[1];""==f&&(f="none");""==b?(b="none",fadeOutRepresentationNGL(c,
c,1)):fadeOutRepresentationNGL(c,c,opacity_fadeout_protein);for(var g in ngl_stage.compList)if(ngl_stage.compList[g].name==c){for(var h in ngl_stage.compList[g].reprList)ngl_stage.compList[g].reprList[h].name==c+".residuesHighlight"&&ngl_stage.compList[g].reprList[h].setSelection(f),ngl_stage.compList[g].reprList[h].name==c+".highlight"&&(protein_residue_sele_string="protein AND ("+b+")",ngl_stage.compList[g].reprList[h].setSelection(protein_residue_sele_string));break}a&&0<a.length?(a=":_ and ("+
a.join(" or ")+")",fadeOutRepresentationNGL(c,c+".ligands",opacity_fadeout_ligand)):0<d.length||0<e.length?(a="none",fadeOutRepresentationNGL(c,c+".ligands",opacity_fadeout_ligand)):(a="none",fadeOutRepresentationNGL(c,c+".ligands",1));(c=getNGLRepresentationByName(c+".ligandsHighlight"))&&c.setSelection(a)}function fadeOutRepresentationNGL(a,b,c){repr=getNGLRepresentationByName(b);repr.setParameters({opacity:c})}
function connectResiduesNGL(a){var b=[];ngl_stage.compList.forEach(function(g){-1<g.name.indexOf("connect")&&b.push(g)});for(var c=0;c<b.length;c++)ngl_stage.removeComponent(b[c]);if(a)for(c=0;c<a.length;c++){var d=getNGLComponentByName(a[c][0].struc_id),e=new NGL.Shape("connect."+c+".line",{disableImpostor:!0});if(d){var f=d.structure.getView(new NGL.Selection(a[c][0].res_num+":"+a[c][0].chain+".CA")).getAtomData().position;d=d.structure.getView(new NGL.Selection(a[c][1].res_num+":"+a[c][1].chain+
".CA")).getAtomData().position;0<f.length&&0<d.length&&(score=Math.min(1,2*a[c][2]),e.addCylinder(f,d,[.9,1-score,1-score],.2),ngl_stage.addComponentFromObject(e).addRepresentation("buffer"))}}}
function changeRepNGL(a){$("#repBtnLbl").text(a.charAt(0).toUpperCase()+a.substring(1));jQuery.cookie("defaultRepr",a,{expires:365,path:"/"});switch(a){case "lines":a="line";break;case "ballAndStick":a="ball+stick";break;case "outline":return}var b=null,c=null;ngl_stage.eachRepresentation(function(d){if(!d.name.match(/(ligands|dna|over|buffer|membrane)/))for(i in b=d.name.split(".")[0],ngl_stage.compList)if(comp=ngl_stage.compList[i],comp.name==b){null===c&&(c=d.repr.type);if("surface"==c&&"surface"!=
a){console.debug("Adding residuesHighlight representation");comp.addRepresentation(a,{name:b+".residuesHighlight",sele:"none",smoothSheet:!0,roughness:1,surfaceType:"sas",probeRadius:1.4,side:"front",opacity:d.getParameters().opacity,scaleFactor:Math.min(1.5,Math.max(.1,5E4/comp.structure.atomCount))});try{refreshBondsAndLigandHighlights()}catch(e){}}comp.removeRepresentation(d);"surface"==a&&d.name==b+".residuesHighlight"?console.debug("Removing surface residuesHighlight"):comp.addRepresentation(a,
{name:d.name,sele:d.getParameters().sele,smoothSheet:!0,surfaceType:"sas",probeRadius:1.4,scaleFactor:Math.min(1.5,Math.max(.1,5E4/comp.structure.atomCount)),roughness:1,side:"front",opacity:d.getParameters().opacity})}})}
function setupNGLRepresentations(a,b,c,d,e){e&&ngl_stage.viewerControls.orient(e);void 0===c&&(c=!1);var f=$.cookie("defaultRepr");null==f?f="cartoon":"ballAndStick"==f?f="ball+stick":"lines"==f&&(f="line");a.setName(b);a.addRepresentation(f,{name:b,sele:"not :_ and not nucleic and not :-",smoothSheet:!0,roughness:1,surfaceType:"sas",probeRadius:1.4,scaleFactor:Math.min(1.5,Math.max(.1,5E4/a.structure.atomCount)),side:"front"});a.addRepresentation("ball+stick",{name:b+".ligands",colorScheme:"element",
sele:":_",side:"front"});a.addRepresentation("ball+stick",{name:b+".residuesHighlight",colorScheme:"element",sele:"none",aspectRatio:1});a.addRepresentation("ball+stick",{name:b+".hover",sele:"none"});c&&(a.addRepresentation("ball+stick",{name:b+".ligandsHighlight",colorScheme:"element",sele:"none"}),"surface"!=f&&a.addRepresentation(f,{name:b+".highlight",sele:"none",smoothSheet:!0,roughness:1,surfaceType:"sas",probeRadius:1.4,scaleFactor:Math.min(1.5,Math.max(.1,5E4/a.structure.atomCount)),side:"front"}));
d.forEach(function(g){scheme="line"==g?"element":"base"==g?"resname":"moleculetype";a.addRepresentation(g,{name:b+".dna",colorScheme:scheme,sele:"nucleic and not :_"})});e?ngl_stage.autoView():"function"==typeof on_viewer_ready_function?on_viewer_ready_function(b,a):a.autoView(1E3);updatecols(b);c&&refreshBondsAndLigandHighlights()}function setColorForAtom(a,b,c){var d=a.structure().createEmptyView();d.addAtom(b);a.colorBy(pv.color.uniform(c),d)}var prevPicked=null;
document.getElementById("pv")&&document.getElementById("pv").addEventListener("mousemove",function(a){if(!pv_viewer._mouseHandler._lastMouseDownTime||!(null==pv_viewer._mouseHandler._lastMouseDownTime||pv_viewer._mouseHandler._lastMouseUpTime<pv_viewer._mouseHandler._lastMouseDownTime)){var b=pv_viewer.boundingClientRect();a=pv_viewer.pick({x:a.clientX-b.left,y:a.clientY-b.top});if(null===prevPicked||null===a||a.target()!==prevPicked.atom){null!==prevPicked&&setColorForAtom(prevPicked.node,prevPicked.atom,
prevPicked.color);if(null!==a){b=a.target();var c=b.qualifiedName().split(".");if("_"!==c[0].charAt(0)&&b.residue()._isAminoacid){var d=[0,0,0,0];a.node().getColorForAtom(b,d);prevPicked={atom:b,color:d,node:a.node()};setColorForAtom(a.node(),b,"red");document.getElementById("pv_status").innerHTML=b.residue().name()+" "+b.residue().num()+" "+c[0];$("body").trigger("highlightResidue",{src:"structure",struc_id:a.object().geom.name(),chain:c[0],resno:b.residue().num()})}else document.getElementById("pv_status").innerHTML=
b.residue().name()+" "+b.residue().num()}else document.getElementById("pv_status").innerHTML="",prevPicked=null;pv_viewer.requestRedraw()}}});
function highlightResiduesPV(a,b,c,d){d||pv_viewer.rm("*_res");d=pv_viewer.get(c);if(null!=d){d=d.structure();if(b){var e=null;e=b.length?d.select({cnames:a.split("")}).residueSelect(function(f){for(var g=0;g<b.length;g++)if(f.num()>=b[g][0]&&f.num()<=b[g][1])return!0;return!1}):d.select({cnames:a.split("")}).residueSelect(function(f){return f.num()==b});pv_viewer.ballsAndSticks((c?c+"_":"")+"res",e);return e}pv_viewer.fitTo(d.select({cnames:a.split("")}));pv_viewer.requestRedraw()}}
function centerResRangePV(a,b,c,d,e,f){d=pv_viewer.get(d);if(null!=d){var g=null;g=1==a.length?d.structure().residueSelect(function(h){return f?h.num()==b&&h.chain().name()==a||h.num()==c&&h.chain().name()==f:e?(h.num()==b||h.num()==c)&&h.chain().name()==a:h.num()>=b&&h.num()<=c&&h.chain().name()==a}):d.structure().residueSelect(function(h){return e?(h.num()==b||h.num()==c)&&-1<a.indexOf(h.chain().name()):h.num()>=b&&h.num()<=c&&-1<a.indexOf(h.chain().name())});pv_viewer.fitTo(g);pv_viewer.requestRedraw()}}
function centerOnLigandPV(a,b){var c=pv_viewer.get(b+".ligands");null!=c&&(c=c.structure(),c=c.residueSelect(function(d){for(var e=0;e<a.length;e++)if(d.num()==a[e])return!0}),pv_viewer.fitTo(c),pv_viewer.requestRedraw())}
function highlightLigandPV(a,b,c){pv_viewer.rm("*ligandContactsHL");null!=pv_viewer.get(c+".ligands")&&a&&(b=pv_viewer.get(c).structure().residueSelect(function(d){var e=d.chain().name();d=d.num();if(e=a[e])for(var f=0;f<e.length;f++)if(d==e[f])return!0}),pv_viewer.lines(c+"ligandContactsHL",b),pv_viewer.requestRedraw())}
function connectResiduesPV(a){pv_viewer.rm("connect.*");if(a)for(var b=0;b<a.length;b++){var c=pv_viewer.customMesh("connect."+b+".line"),d=pv_viewer.get(a[b][0].struc_id);if(d){d=d.structure();var e=d.atom(a[b][0].chain+"."+a[b][0].res_num+".CA");d=d.atom(a[b][1].chain+"."+a[b][1].res_num+".CA");if(e&&d){var f=pv.vec3.clone(e.pos());pv.vec3.add(f,f,d.pos());pv.vec3.scale(f,f,.5);score=Math.min(1,2*a[b][2]);c.addTube(e.pos(),d.pos(),.1,{color:[.9,1-score,1-score]})}}}pv_viewer.requestRedraw()}
function changeRepPV(a){a.match(/(cartoon|tube|trace|lines|outline|fog)/)||(a="cartoon");if("outline"==a)jQuery.cookie("pv_outline",!pv_viewer.options("outline"),{expires:365,path:"/"}),pv_viewer.options("outline",!pv_viewer.options("outline"));else if("fog"==a)jQuery.cookie("pv_fog",!pv_viewer.options("fog"),{expires:365,path:"/"}),pv_viewer.options("fog",!pv_viewer.options("fog"));else if(a.match(/(cartoon|tube|trace|lines|ballAndStick)/)){$("#repBtnLbl").text(a.charAt(0).toUpperCase()+a.substring(1));
jQuery.cookie("defaultRepr",a,{expires:365,path:"/"});var b=[],c=[];pv_viewer.forEach(function(g){var h=g.name();h.match(/(ligand|dna|res|LigandBond|membrane)/)||(b.push(h),c.push(g.structure()))});for(var d=0;d<b.length;d++)pv_viewer.rm(b[d]);for(d=0;d<c.length;d++){var e=b[d],f=c[d];switch(a){case "cartoon":pv_viewer.cartoon(e,f,{color:pv.color.uniform("white")});break;case "tube":pv_viewer.tube(e,f,{color:pv.color.uniform("white")});break;case "trace":pv_viewer.trace(e,f,{color:pv.color.uniform("white")});
break;case "lines":pv_viewer.lines(e,f,{color:pv.color.uniform("white")});break;case "ballAndstick":pv_viewer.ballsAndSticks(e,f,{color:pv.color.uniform("white")})}}}}function normalize(a){var b=[],c=a[0],d=a[1],e=a[2];c=c*c+d*d+e*e;0<c&&(c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c);return b}function dot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function cross(a,b){var c=[],d=a[0],e=a[1],f=a[2],g=b[0],h=b[1],k=b[2];c[0]=e*k-f*h;c[1]=f*g-d*k;c[2]=d*h-e*g;return c}
function distance(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)}
function showMembrane(a,b){var c=membraneData[a];if(c){var d=null;if(0<$("#pv:visible",currentWin.document).length){if(!pv_viewer.get(a))return;d="pv";if(!b){pv_viewer.hide(a+".membrane");pv_viewer.requestRedraw();return}if(pv_viewer.get(a+".membrane")){pv_viewer.show(a+".membrane");pv_viewer.requestRedraw();return}}if(0<$("#ngl:visible",currentWin.document).length){d="ngl";if(!getNGLComponentByName(a))return;var e=getNGLComponentByName(a+".membrane");if(e){e.setVisibility(b);return}if(!b)return}e=
[0,1,0];1<=dot(c.axis,e)&&(e=[0,0,1]);plane_x=normalize(cross(c.axis,e));plane_y=normalize(cross(c.axis,plane_x));e=[];var f=[],g=[];"pv"==d?pv_viewer.get(a).structure().eachAtom(function(t){"CA"==t.name()&&g.push(t.pos())}):"ngl"==d&&getNGLComponentByName(a).structure.eachResidue(function(t){t.eachAtom(function(v){"CA"==v.atomname&&g.push([v.x,v.y,v.z])})});for(var h=[],k="",n=1,m=c.radius/2+24,p=-m;p<m;p+=1.5)for(var q=-m;q<m;q+=1.5)if(pos=[c.plane_one_center[0]+1.5*p*plane_x[0]+1.5*q*plane_y[0],
c.plane_one_center[1]+1.5*p*plane_x[1]+1.5*q*plane_y[1],c.plane_one_center[2]+1.5*p*plane_x[2]+1.5*q*plane_y[2]],!(distance(pos,c.plane_one_center)>c.radius+8)){pos2=[c.plane_two_center[0]+1.5*p*plane_x[0]+1.5*q*plane_y[0],c.plane_two_center[1]+1.5*p*plane_x[1]+1.5*q*plane_y[1],c.plane_two_center[2]+1.5*p*plane_x[2]+1.5*q*plane_y[2]];for(var r=0;r<g.length;)5>distance(pos,g[r])?e.push(g.splice(r,1)[0]):5>distance(pos2,g[r])?f.push(g.splice(r,1)[0]):r++;h.push([pos,pos2])}for(m=0;m<h.length;m++){p=
e;q=0;do{r=!1;for(var u=h[m][q++],l=0;l<p.length;l++)if(5>distance(u,p[l])){r=!0;break}r||(k+="ATOM  "+("     "+n++).slice(-5)+"   -  MEM M   1    "+("        "+u[0].toFixed(3)).slice(-8)+("        "+u[1].toFixed(3)).slice(-8)+("        "+u[2].toFixed(3)).slice(-8)+"  1.00  0.00    \n");p=f}while(2>q)}k+="END";if("pv"==d)pv_viewer.points(a+".membrane",pv.io.pdb(k),{color:pv.color.uniform("#8b8b8b"),pointSize:2}),c.viewTransform&&pv_viewer.setRotation(c.viewTransform);else if("ngl"==d){for(schemeId in NGL.ColormakerRegistry.userSchemes)-1<
schemeId.indexOf(a+".membrane")&&NGL.ColormakerRegistry.removeScheme(schemeId);membraneData[a].viewTransform&&ngl_stage.viewerControls.orient(membraneData[a].viewTransform);schemeId=NGL.ColormakerRegistry.addScheme(function(t){this.atomColor=function(){return 9868950}},a+".membrane");c=new Blob([k],{type:"text/plain"});ngl_stage.loadFile(c,{ext:"pdb"}).then(function(t){t.setName(a+".membrane");t.addRepresentation("point",{name:a+".membrane",pointSize:2,useTexture:!0,forceTransparent:!0,edgeBleach:.6,
color:schemeId});membraneData[a].viewTransform&&ngl_stage.viewerControls.spin([0,1,0],Math.PI);ngl_stage.autoView()})}}}function midpoint1d(a,b,c){return a+(b-a)*c}function midpoint3d(a,b,c){return[midpoint1d(a[0],b[0],c),midpoint1d(a[1],b[1],c),midpoint1d(a[2],b[2],c)]}function showWaterPV(){pv_viewer.ballsAndSticks("water",pv_viewer.get("template").structure().select({rnames:["HOH"]}))}function showWaterNGL(){log.console("showWaterNGL not implemented")}
function showWater(){0<$("#pv:visible",currentWin.document).length&&showWaterPV();0<$("#ngl:visible",currentWin.document).length&&showWaterNGL()}function toggleBond(a,b){PLIP.AbstractViewer.isStructureEnabled(a)&&(plip_bonds.getBondById(a,b).toggle(),deHighlightBond(a,b,!0))}function highlightBond(a,b){PLIP.AbstractViewer.isStructureEnabled(a)&&plip_bonds.getBondById(a,b).highlight()}
function deHighlightBond(a,b,c){PLIP.AbstractViewer.isStructureEnabled(a)&&(null==c&&(c=!0),plip_bonds.getBondById(a,b).dehighlight(!0,c))}function highlightBonds(a,b){PLIP.AbstractViewer.isStructureEnabled(a)&&(plip_bonds.getBondsById(a,b).forEach(function(c){c.highlight(!1)}),plip_residues.redraw(a))}function deHighlightBonds(a,b){PLIP.AbstractViewer.isStructureEnabled(a)&&(plip_bonds.getBondsById(a,b).forEach(function(c){c.dehighlight(!1)}),plip_residues.redraw(a))}
function clickBonds(a,b,c){toggleBonds(a,b,c);$("#plip_bonds_"+c).prop("checked")&&fitToBonds(a,b,c)}function toggleBonds(a,b,c){a=$("#plip_bonds_"+c);b=a.prop("checked");a.prop("checked",!b);a.trigger("change")}
function changeBondsCheckbox(a,b,c){var d=$("#plip_bonds_"+c),e=d.prop("checked");PLIP.AbstractViewer.isStructureEnabled(a)?(plip_bonds.getBondsById(a,b).forEach(function(f){e?f.show(!1):f.hide(!1);f.dehighlight(!1,!0)}),plip_residues.redraw(a),e&&plip_interactions_fit_bonds&&fitToBonds(a,b,c)):d.prop("checked",!1)}function showBonds(a,b){PLIP.AbstractViewer.isStructureEnabled(a)&&(plip_bonds.getBondsById(a,b).forEach(function(c){c.show(!1);c.dehighlight(!1,!0)}),plip_residues.redraw(a))}
function hideBonds(a,b){PLIP.AbstractViewer.isStructureEnabled(a)&&(plip_bonds.getBondsById(a,b).forEach(function(c){c.hide(!1);c.dehighlight(!1,!0)}),plip_residues.redraw(a))}function fitToBond(a,b){PLIP.AbstractViewer.isStructureEnabled(a)&&plip_bonds.getBondById(a,b).fitView()}
function fitToResidue(a,b,c){PLIP.AbstractViewer.isStructureEnabled(a)&&(residue=plip_residues.getResidue(a,b),c?(ligand=all_ligands.getLigandById(a,c),PLIP.AbstractViewer.fitView(a,[ligand],[residue])):PLIP.AbstractViewer.fitView(a,null,[residue]))}function fitToBonds(a,b){PLIP.AbstractViewer.isStructureEnabled(a)&&plip_bonds.fitViewBonds(a,b)}
function showResidues(a,b,c){PLIP.AbstractViewer.isStructureEnabled(a)&&(plip_residues.getResiduesByResId(a,b).forEach(function(d){d.show(!1)}),plip_residues.redraw(a))}function hideResidues(a,b,c){PLIP.AbstractViewer.isStructureEnabled(a)&&(plip_residues.getResiduesByResId(a,b).forEach(function(d){d.hide(!1)}),plip_residues.redraw(a))}function showLigands(a,b){PLIP.AbstractViewer.isStructureEnabled(a)&&(all_ligands.getLigandsById(a,b).forEach(function(c){c.show(!1,!0)}),all_ligands.redraw(a))}
function hideLigands(a,b){PLIP.AbstractViewer.isStructureEnabled(a)&&(all_ligands.getLigandsById(a,b).forEach(function(c){c.hide(!1,null,!0)}),all_ligands.redraw(a))}
PLIP.Bonds=function(){var a={};this.hasStruc=function(b){return b in a};this.removeStruc=function(b){b in a&&delete a[b]};this.addStruc=function(b){this.hasStruc(b)||(a[b]=[])};this.listStruc=function(){return Object.keys(a)};this.listVisible=function(b){if(this.hasStruc(b))return a[b].filter(function(c){return c.isVisible()});console.error("listVisible: no strucId "+b)};this.getBondById=function(b,c){if(b in a)return a[b].find(function(d){return d.id===c});console.error("getBondById: no strucId "+
b);console.trace()};this.getBondsById=function(b,c){if(b in a)return a[b].filter(function(d){return c.includes(d.id)});console.error("getBondsById: no strucId "+b)};this.add=function(b){this.addStruc(b.strucId);a[b.strucId].push(b)};this.showAll=function(b){for(var c=a[b],d=0;d<c.length;d++)c[d].isVisible()||c[d].show(!1);plip_residues.redraw(b)};this.hideAll=function(b){for(var c=a[b],d=0;d<c.length;d++)c[d].isVisible()&&c[d].hide(!1);plip_residues.redraw(b)};this.fitViewBonds=function(b,c){var d=
this.getBondsById(b,c),e=d.map(function(f){return f.ligand}).filter(function(f,g,h){return h.indexOf(f)==g});d=d.map(function(f){return f.residue}).filter(function(f,g,h){return h.indexOf(f)==g});PLIP.AbstractViewer.fitView(b,e,d)};this.refresh=function(b){for(var c=0;c<a[b].length;c++)a[b][c].refresh()};this.refreshAll=function(){for(var b in a)PLIP.AbstractViewer.isStructureEnabled(b)&&this.refresh(b)}};
PLIP.Bond=function(a,b,c,d,e,f,g,h,k){var n=!1,m=!1,p=void 0,q="LigandBond"+a,r=void 0,u="LigandBondHighlight"+a;this.show=function(l){null==l&&(l=!0);this.isVisible()?console.info("Bond already visible"):PLIP.AbstractViewer.isStructureEnabled(this.strucId)&&(this.draw(),void 0!==this.residue&&this.residue.show(!1),this.ligand.show(l),n=!0,l&&pv_viewer.requestRedraw())};this.hide=function(l){null==l&&(l=!0);PLIP.AbstractViewer.isStructureEnabled(this.strucId)&&this.isVisible()&&(this.destroy(),n=
!1,void 0!==this.residue&&this.residue.hide(!1),this.ligand.hide(l),l&&pv_viewer.requestRedraw())};this.draw=function(){null==this.coo3?PLIP.AbstractViewer.addBondLine(this.getBondMesh(),this.coo1,this.coo2,plip_bond_num_dash,plip_bond_radius,this.color,!0):(PLIP.AbstractViewer.addBondLine(this.getBondMesh(),this.coo1,this.coo3,plip_bond_num_dash,plip_bond_radius,this.color,!1),PLIP.AbstractViewer.addBondLine(this.getBondMesh(),this.coo2,this.coo3,plip_bond_num_dash,plip_bond_radius,this.color,!1),
PLIP.AbstractViewer.addWaterCircle(this.getBondMesh(),this.coo3,2*plip_bond_radius,this.color,!0))};this.destroy=function(){p=PLIP.AbstractViewer.removeMesh(q)};this.refresh=function(){this.destroy();this.isVisible()&&this.draw();this.destroyHighlight();this.isHighlighted()&&this.drawHighlight()};this.toggle=function(){this.isVisible()?this.hide():this.show()};this.isVisible=function(){return n};this.getBondMesh=function(){void 0==p&&(p=PLIP.AbstractViewer.newBondMesh(q));return p};this.highlight=
function(l){null==l&&(l=!0);PLIP.AbstractViewer.isStructureEnabled(this.strucId)&&!this.isHighlighted()&&(this.drawHighlight(),void 0!==this.residue&&this.residue.show(!1),this.ligand.show(l),m=!0)};this.drawHighlight=function(){null==this.coo3?PLIP.AbstractViewer.addBondLine(this.getBondMeshHighlight(),this.coo1,this.coo2,plip_higlight_bond_num_dash,plip_bond_radius*plip_higlight_factor,this.color,!0):(PLIP.AbstractViewer.addBondLine(this.getBondMeshHighlight(),this.coo1,this.coo3,plip_higlight_bond_num_dash,
plip_bond_radius*plip_higlight_factor,this.color,!1),PLIP.AbstractViewer.addBondLine(this.getBondMeshHighlight(),this.coo2,this.coo3,plip_higlight_bond_num_dash,plip_bond_radius*plip_higlight_factor,this.color,!1),PLIP.AbstractViewer.addWaterCircle(this.getBondMeshHighlight(),this.coo3,plip_bond_radius*plip_higlight_factor*2,this.color,!0))};this.destroyHighlight=function(){r=PLIP.AbstractViewer.removeMesh(u)};this.dehighlight=function(l){null==l&&(l=!0);PLIP.AbstractViewer.isStructureEnabled(this.strucId)&&
this.isHighlighted()&&this.isHighlighted()&&(this.destroyHighlight(),void 0!==this.residue&&this.residue.hide(!1),this.ligand.hide(l),m=!1,l&&pv_viewer.requestRedraw())};this.toggleHighlight=function(){this.isHighlighted()?this.dehighlight():this.highlight()};this.isHighlighted=function(){return m};this.getBondMeshHighlight=function(){void 0==r&&(r=PLIP.AbstractViewer.newBondMesh(u));return r};this.fitView=function(){PLIP.AbstractViewer.fitView(this.strucId,[this.ligand],[this.residue])};this.getLigand=
function(){return this.ligand};this.residue=plip_residues.addResidue(b,h[0],h[1],h[2]);this.residue.addBond(this);this.id=a;this.strucId=b;this.ligand=c;this.coo1=d;this.coo2=e;this.coo3=f;this.color=g;k&&this.show()};PLIP.makeResidueId=function(a,b,c){return a+":"+b+c};
PLIP.Residue=function(a,b,c,d){var e=0,f=[];this.show=function(g){null==g&&(g=!0);PLIP.AbstractViewer.isStructureEnabled(this.strucId)&&(e++,0<e&&g&&plip_residues.redraw(this.strucId))};this.hide=function(g,h){null==g&&(g=!0);null==h&&(h=!0);PLIP.AbstractViewer.isStructureEnabled(this.strucId)&&(h?e=Math.max(e-1,0):alert("Did not decrement counter! "+this.id+": "+e),0==e&&g&&plip_residues.redraw(this.strucId))};this.isVisible=function(){return 0<e};this.getOldResId=function(){return this.chain+this.position};
this.addBond=function(g){f.push(g)};this.getBonds=function(){return f};this.strucId=a;this.id=PLIP.makeResidueId(b,c,d);this.chain=b;this.one_letter=c;this.position=d};
PLIP.Residues=function(){var a={};this.hasStruc=function(b){return b in a};this.removeStruc=function(b){b in a&&delete a[b]};this.addStruc=function(b){this.hasStruc(b)||(a[b]=[])};this.listStruc=function(){return Object.keys(a)};this.getStruc=function(b){if(b in a)return a[b];void 0===b?console.error("StrucId is undefined"):console.error("No such strucId: '"+b+"'");console.trace()};this.addResidue=function(b,c,d,e){this.addStruc(b);var f=PLIP.makeResidueId(c,d,e);f=this.getResidue(b,f);void 0===f&&
(f=new PLIP.Residue(b,c,d,e),this.getStruc(b).push(f));return f};this.getResidue=function(b,c){if(b in a)return this.getStruc(b).find(function(d){return d.id==c})};this.getResidueByOldResId=function(b,c){if(b in a)return this.getStruc(b).find(function(d){return d.getOldResId()==c})};this.getResiduesByResId=function(b,c){if(b in a)return a[b].filter(function(d){return c.includes(d.id)})};this.getVisibleResidues=function(b){return this.hasStruc(b)?this.getStruc(b).filter(function(c){return c.isVisible()}):
[]};this.getVisibleResiduesResId=function(b){return this.getVisibleResidues(b).map(function(c){return c.getOldResId()})};this.redraw=function(b){highlightLigand(all_ligands.getVisibleLigandIds(b),this.getVisibleResiduesResId(b),b);pv_viewer.requestRedraw()};this.redrawAll=function(){for(var b in a)PLIP.AbstractViewer.isStructureEnabled(b)&&this.redraw(b)}};
PLIP.Ligands=function(){var a={};this.hasStruc=function(b){return b in a};this.removeStruc=function(b){this.hasStruc(b)&&delete a[b]};this.addStruc=function(b){this.hasStruc(b)||(a[b]=[])};this.listStruc=function(){return Object.keys(a)};this.getStruc=function(b){if(this.hasStruc(b))return a[b];void 0===b?console.error("StrucId "+b+" is undefined"):console.error("No such strucId: '"+b+"'");console.trace()};this.getLigandById=function(b,c){if(this.hasStruc(b))return a[b].find(function(d){return d.id===
c});console.error("getLigandById: no strucId "+b);console.trace()};this.getLigandsById=function(b,c){if(this.hasStruc(b))return a[b].filter(function(d){return c.includes(d.id)});console.error("getLigandsById: no strucId "+b)};this.addLigand=function(b,c){this.addStruc(b);var d=this.getLigandById(b,c);void 0===d&&(d=new PLIP.Ligand(b,c),this.getStruc(b).push(d));return d};this.getVisibleLigands=function(b){return this.hasStruc(b)?this.getStruc(b).filter(function(c){return c.isVisible()}):[]};this.getVisibleLigandIds=
function(b){return this.getVisibleLigands(b).map(function(c){return c.getLigandId()})};this.redraw=function(b){highlightLigand(this.getVisibleLigandIds(b),plip_residues.getVisibleResiduesResId(b),b);pv_viewer.requestRedraw()};this.redrawAll=function(){for(var b in a)PLIP.AbstractViewer.isStructureEnabled(b)&&this.redraw(b)}};
PLIP.Ligand=function(a,b){var c=0,d=[],e=[];this.show=function(f,g){null==f&&(f=!0);null==g&&(g=!1);PLIP.AbstractViewer.isStructureEnabled(this.strucId)&&(c++,g&&d.forEach(function(h){h.show(!1)}),0<c&&f&&all_ligands.redraw(this.strucId))};this.hide=function(f,g,h){null==f&&(f=!0);null==h&&(h=!1);null==g&&(g=!0);PLIP.AbstractViewer.isStructureEnabled(this.strucId)&&(g?c=Math.max(c-1,0):alert("Did not decrement counter! "+this.id+": "+c),h&&d.forEach(function(k){k.hide(!1)}),0==c&&f&&all_ligands.redraw(this.strucId))};
this.addResidue=function(f){-1==d.indexOf(f)&&d.push(f)};this.addBond=function(f){-1==e.indexOf(f)&&e.push(f)};this.isVisible=function(){return 0<c};this.getLigandId=function(){return this.id};this.getResidues=function(){return d};this.strucId=a;this.position=this.id=b};
PLIP.AbstractViewerPV={newBondMesh:function(a){return pv_viewer.customMesh(a)},addWaterCircle:function(a,b,c,d,e){a.addSphere(b,c,{cap:!0,color:d})},addBondLine:function(a,b,c,d,e,f,g){for(g=1;g<=d;g++)a.addTube(midpoint3d(b,c,(2*g-2)/(2*d-1)),midpoint3d(b,c,(2*g-1)/(2*d-1)),e,{cap:!0,color:f})},removeMesh:function(a){pv_viewer.rm(a)},fitView:function(a,b,c){if(this.isStructureEnabled(a)){var d=c.map(function(f){return void 0===f?null:f.chain}),e=c.map(function(f){return void 0===f?null:f.position});
d.length!=e.length&&console.error("queryResidue -Chains and -Positions array lengths don't match: "+d.length+" != "+e.length);c=pv_viewer.get(a).structure().residueSelect(function(f){var g=f.chain().name();if("_"===g){if(!b)return!1;ligand_positions=b.map(function(k){return k.position});if(ligand_positions.includes(f.num()))return!0}for(var h=0;h<d.length;h++)if(d[h]===g&&e[h]===f.num())return!0;return!1});pv_viewer.fitTo(c);pv_viewer.requestRedraw()}},isStructureEnabled:function(a){return pv_viewer.get(a)?
!0:!1}};
PLIP.AbstractViewerNGL={newBondMesh:function(a){return new NGL.Shape(a,{disableImpostor:!0})},addWaterCircle:function(a,b,c,d,e){a.addEllipsoid(b,d,c,[c,0,0],[0,c,0]);e&&ngl_stage.addComponentFromObject(a).addRepresentation("buffer")},addBondLine:function(a,b,c,d,e,f,g){for(var h=1;h<=d;h++)a.addCylinder(midpoint3d(b,c,(2*h-2)/(2*d-1)),midpoint3d(b,c,(2*h-1)/(2*d-1)),f,e);g&&ngl_stage.addComponentFromObject(a).addRepresentation("buffer")},removeMesh:function(a){removeNGLComponentByName(a)},fitView:function(a,
b,c){if(this.isStructureEnabled(a)){var d="";b&&(ligand_positions=b.map(function(h){return h.position}),d+="(("+ligand_positions.join(" or ")+") and :_)");if(void 0!==c[0]){b={};for(var e in c){var f=c[e],g=f.chain;"-"!=g&&(f=f.position,b[g]?b[g].push(f):b[g]=[f])}for(g in b)""!=d&&(d+=" or "),d+="(("+b[g].join(" or ")+") and :"+g+")"}getNGLComponentByName(a).autoView(d,1E3)}},isStructureEnabled:function(a){return getNGLComponentByName(a)?!0:!1}};
function togglePLIPLigandContacts(a,b,c){$("#togglePLIPLigandContacts_"+a).hasClass("glyphicon-chevron-down")?showPLIPLigandContacts(a,b,c):hidePLIPLigandContacts(a,b,c)}function showPLIPLigandContacts(a,b,c){$("#PLIPligandContacts_"+a).show(100);setTimeout(function(){$("#togglePLIPLigandContacts_"+a).addClass("glyphicon-chevron-up").removeClass("glyphicon-chevron-down")},100);void 0!==c&&(showBonds(b,c),fitToBonds(b,c))}
function hidePLIPLigandContacts(a,b,c){$("#PLIPligandContacts_"+a).hide(100);setTimeout(function(){$("#togglePLIPLigandContacts_"+a).addClass("glyphicon-chevron-down").removeClass("glyphicon-chevron-up")},100);void 0!==c&&hideBonds(b,c)}var plip_interactions_fit_bonds=!0;
function togglePlipInteractions(a,b,c){$("#togglePlipInteractions_"+a).hasClass("glyphicon-chevron-down")?($("#togglePlipInteractions_"+a).removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up"),$("#plipInteractions_"+a).show(),PLIP.AbstractViewer.isStructureEnabled(b)&&(plip_interactions_fit_bonds=!1,$.when($("#plipInteractions_"+a+" input").each(function(d,e){$(e).prop("checked",!0).trigger("change")})).done(function(){fitToBonds(b,c)}),plip_interactions_fit_bonds=!0)):($("#togglePlipInteractions_"+
a).addClass("glyphicon-chevron-down").removeClass("glyphicon-chevron-up"),$("#plipInteractions_"+a).hide(),$("#plipInteractions_"+a+" input").each(function(d,e){$(e).prop("checked",!1).trigger("change")}))}
function changeLigandContacts4Checkbox(a,b,c,d){d=$("#chainContacts4_"+d);var e=d.prop("checked");PLIP.AbstractViewer.isStructureEnabled(a)?(plip_residues.getResiduesByResId(a,c).forEach(function(f){e?f.show(!1):f.hide(!1)}),b=all_ligands.getLigandById(a,b),e?b.show(!0,!1):b.hide(!0,null,!1),plip_residues.redraw(a)):d.prop("checked",!1)}
function clickLigandContacts4Checkbox(a,b,c,d){PLIP.AbstractViewer.isStructureEnabled(a)&&($("#chainContacts4_"+d).each(function(e,f){$(f).prop("checked",!$(f).prop("checked")).trigger("change")}),$("#chainContacts4_"+d).prop("checked")&&PLIP.AbstractViewer.fitView(a,[all_ligands.getLigandById(a,b)],plip_residues.getResiduesByResId(a,c)))}
function toggleResidueContacts(a,b,c){$("#toggleResidueContacts4_"+a).hasClass("glyphicon-chevron-down")?($("#toggleResidueContacts4_"+a).removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up"),$("#residueContacts4_"+a).show(),PLIP.AbstractViewer.isStructureEnabled(c)&&($("#residueContacts4_"+a+" input").each(function(d,e){$(e).prop("checked",!0).trigger("change")}),ligand=all_ligands.getLigandById(c,b),PLIP.AbstractViewer.fitView(c,[ligand],ligand.getResidues()))):($("#toggleResidueContacts4_"+
a).removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down"),$("#residueContacts4_"+a).hide(),PLIP.AbstractViewer.isStructureEnabled(c)&&$("#residueContacts4_"+a+" input").each(function(d,e){$(e).prop("checked",!1).trigger("change")}));updatecols()}
function toggleLigandGroup(a,b,c){$("#toggleLigandGroup_"+a).hasClass("glyphicon-chevron-down")?($("#toggleLigandGroup_"+a).addClass("glyphicon-chevron-up").removeClass("glyphicon-chevron-down"),$("#ligandGroup_"+a).show(),centerOnLigand(b,c)):($("#toggleLigandGroup_"+a).addClass("glyphicon-chevron-down").removeClass("glyphicon-chevron-up"),$("#ligandGroup_"+a+" .glyphicon-chevron-up").each(function(d,e){$(e).trigger("click")}),$("#ligandGroup_"+a).hide());updatecols()}
function toggleAllLigands(a){$("#toggleAllLink").hasClass("glyphicon-chevron-down")?($("#toggleAllLink,span[id^=toggleLigandGroup_]").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up"),$("div[id^=ligandGroup_]").show()):($("#toggleAllLink,span[id^=toggleLigandGroup_]").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down"),$("div[id^=ligandGroup_]").hide())};